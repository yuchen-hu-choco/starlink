{"ast":null,"code":"import reverse from \"./reverse.js\";\nimport transform from \"./transform.js\";\nexport default function (topology, o) {\n  if (typeof o === \"string\") o = topology.objects[o];\n  return o.type === \"GeometryCollection\" ? {\n    type: \"FeatureCollection\",\n    features: o.geometries.map(function (o) {\n      return feature(topology, o);\n    })\n  } : feature(topology, o);\n}\n\nfunction feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {\n    type: \"Feature\",\n    properties: properties,\n    geometry: geometry\n  } : bbox == null ? {\n    type: \"Feature\",\n    id: id,\n    properties: properties,\n    geometry: geometry\n  } : {\n    type: \"Feature\",\n    id: id,\n    bbox: bbox,\n    properties: properties,\n    geometry: geometry\n  };\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n\n\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type,\n        coordinates;\n\n    switch (type) {\n      case \"GeometryCollection\":\n        return {\n          type: type,\n          geometries: o.geometries.map(geometry)\n        };\n\n      case \"Point\":\n        coordinates = point(o.coordinates);\n        break;\n\n      case \"MultiPoint\":\n        coordinates = o.coordinates.map(point);\n        break;\n\n      case \"LineString\":\n        coordinates = line(o.arcs);\n        break;\n\n      case \"MultiLineString\":\n        coordinates = o.arcs.map(line);\n        break;\n\n      case \"Polygon\":\n        coordinates = polygon(o.arcs);\n        break;\n\n      case \"MultiPolygon\":\n        coordinates = o.arcs.map(polygon);\n        break;\n\n      default:\n        return null;\n    }\n\n    return {\n      type: type,\n      coordinates: coordinates\n    };\n  }\n\n  return geometry(o);\n}","map":{"version":3,"sources":["D:/eclipse/work3/starlink/node_modules/topojson-client/src/feature.js"],"names":["reverse","transform","topology","o","objects","type","features","geometries","map","feature","id","bbox","properties","geometry","object","transformPoint","arcs","arc","i","points","length","pop","a","k","n","push","point","p","line","ring","polygon","coordinates"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,cAApB;AACA,OAAOC,SAAP,MAAsB,gBAAtB;AAEA,eAAe,UAASC,QAAT,EAAmBC,CAAnB,EAAsB;AACnC,MAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2BA,CAAC,GAAGD,QAAQ,CAACE,OAAT,CAAiBD,CAAjB,CAAJ;AAC3B,SAAOA,CAAC,CAACE,IAAF,KAAW,oBAAX,GACD;AAACA,IAAAA,IAAI,EAAE,mBAAP;AAA4BC,IAAAA,QAAQ,EAAEH,CAAC,CAACI,UAAF,CAAaC,GAAb,CAAiB,UAASL,CAAT,EAAY;AAAE,aAAOM,OAAO,CAACP,QAAD,EAAWC,CAAX,CAAd;AAA8B,KAA7D;AAAtC,GADC,GAEDM,OAAO,CAACP,QAAD,EAAWC,CAAX,CAFb;AAGD;;AAED,SAASM,OAAT,CAAiBP,QAAjB,EAA2BC,CAA3B,EAA8B;AAC5B,MAAIO,EAAE,GAAGP,CAAC,CAACO,EAAX;AAAA,MACIC,IAAI,GAAGR,CAAC,CAACQ,IADb;AAAA,MAEIC,UAAU,GAAGT,CAAC,CAACS,UAAF,IAAgB,IAAhB,GAAuB,EAAvB,GAA4BT,CAAC,CAACS,UAF/C;AAAA,MAGIC,QAAQ,GAAGC,MAAM,CAACZ,QAAD,EAAWC,CAAX,CAHrB;AAIA,SAAOO,EAAE,IAAI,IAAN,IAAcC,IAAI,IAAI,IAAtB,GAA6B;AAACN,IAAAA,IAAI,EAAE,SAAP;AAAkBO,IAAAA,UAAU,EAAEA,UAA9B;AAA0CC,IAAAA,QAAQ,EAAEA;AAApD,GAA7B,GACDF,IAAI,IAAI,IAAR,GAAe;AAACN,IAAAA,IAAI,EAAE,SAAP;AAAkBK,IAAAA,EAAE,EAAEA,EAAtB;AAA0BE,IAAAA,UAAU,EAAEA,UAAtC;AAAkDC,IAAAA,QAAQ,EAAEA;AAA5D,GAAf,GACA;AAACR,IAAAA,IAAI,EAAE,SAAP;AAAkBK,IAAAA,EAAE,EAAEA,EAAtB;AAA0BC,IAAAA,IAAI,EAAEA,IAAhC;AAAsCC,IAAAA,UAAU,EAAEA,UAAlD;AAA8DC,IAAAA,QAAQ,EAAEA;AAAxE,GAFN;AAGD;;AAED,OAAO,SAASC,MAAT,CAAgBZ,QAAhB,EAA0BC,CAA1B,EAA6B;AAClC,MAAIY,cAAc,GAAGd,SAAS,CAACC,QAAQ,CAACD,SAAV,CAA9B;AAAA,MACIe,IAAI,GAAGd,QAAQ,CAACc,IADpB;;AAGA,WAASC,GAAT,CAAaC,CAAb,EAAgBC,MAAhB,EAAwB;AACtB,QAAIA,MAAM,CAACC,MAAX,EAAmBD,MAAM,CAACE,GAAP;;AACnB,SAAK,IAAIC,CAAC,GAAGN,IAAI,CAACE,CAAC,GAAG,CAAJ,GAAQ,CAACA,CAAT,GAAaA,CAAd,CAAZ,EAA8BK,CAAC,GAAG,CAAlC,EAAqCC,CAAC,GAAGF,CAAC,CAACF,MAAhD,EAAwDG,CAAC,GAAGC,CAA5D,EAA+D,EAAED,CAAjE,EAAoE;AAClEJ,MAAAA,MAAM,CAACM,IAAP,CAAYV,cAAc,CAACO,CAAC,CAACC,CAAD,CAAF,EAAOA,CAAP,CAA1B;AACD;;AACD,QAAIL,CAAC,GAAG,CAAR,EAAWlB,OAAO,CAACmB,MAAD,EAASK,CAAT,CAAP;AACZ;;AAED,WAASE,KAAT,CAAeC,CAAf,EAAkB;AAChB,WAAOZ,cAAc,CAACY,CAAD,CAArB;AACD;;AAED,WAASC,IAAT,CAAcZ,IAAd,EAAoB;AAClB,QAAIG,MAAM,GAAG,EAAb;;AACA,SAAK,IAAID,CAAC,GAAG,CAAR,EAAWM,CAAC,GAAGR,IAAI,CAACI,MAAzB,EAAiCF,CAAC,GAAGM,CAArC,EAAwC,EAAEN,CAA1C,EAA6CD,GAAG,CAACD,IAAI,CAACE,CAAD,CAAL,EAAUC,MAAV,CAAH;;AAC7C,QAAIA,MAAM,CAACC,MAAP,GAAgB,CAApB,EAAuBD,MAAM,CAACM,IAAP,CAAYN,MAAM,CAAC,CAAD,CAAlB,EAHL,CAG6B;;AAC/C,WAAOA,MAAP;AACD;;AAED,WAASU,IAAT,CAAcb,IAAd,EAAoB;AAClB,QAAIG,MAAM,GAAGS,IAAI,CAACZ,IAAD,CAAjB;;AACA,WAAOG,MAAM,CAACC,MAAP,GAAgB,CAAvB,EAA0BD,MAAM,CAACM,IAAP,CAAYN,MAAM,CAAC,CAAD,CAAlB,EAFR,CAEgC;;;AAClD,WAAOA,MAAP;AACD;;AAED,WAASW,OAAT,CAAiBd,IAAjB,EAAuB;AACrB,WAAOA,IAAI,CAACR,GAAL,CAASqB,IAAT,CAAP;AACD;;AAED,WAAShB,QAAT,CAAkBV,CAAlB,EAAqB;AACnB,QAAIE,IAAI,GAAGF,CAAC,CAACE,IAAb;AAAA,QAAmB0B,WAAnB;;AACA,YAAQ1B,IAAR;AACE,WAAK,oBAAL;AAA2B,eAAO;AAACA,UAAAA,IAAI,EAAEA,IAAP;AAAaE,UAAAA,UAAU,EAAEJ,CAAC,CAACI,UAAF,CAAaC,GAAb,CAAiBK,QAAjB;AAAzB,SAAP;;AAC3B,WAAK,OAAL;AAAckB,QAAAA,WAAW,GAAGL,KAAK,CAACvB,CAAC,CAAC4B,WAAH,CAAnB;AAAoC;;AAClD,WAAK,YAAL;AAAmBA,QAAAA,WAAW,GAAG5B,CAAC,CAAC4B,WAAF,CAAcvB,GAAd,CAAkBkB,KAAlB,CAAd;AAAwC;;AAC3D,WAAK,YAAL;AAAmBK,QAAAA,WAAW,GAAGH,IAAI,CAACzB,CAAC,CAACa,IAAH,CAAlB;AAA4B;;AAC/C,WAAK,iBAAL;AAAwBe,QAAAA,WAAW,GAAG5B,CAAC,CAACa,IAAF,CAAOR,GAAP,CAAWoB,IAAX,CAAd;AAAgC;;AACxD,WAAK,SAAL;AAAgBG,QAAAA,WAAW,GAAGD,OAAO,CAAC3B,CAAC,CAACa,IAAH,CAArB;AAA+B;;AAC/C,WAAK,cAAL;AAAqBe,QAAAA,WAAW,GAAG5B,CAAC,CAACa,IAAF,CAAOR,GAAP,CAAWsB,OAAX,CAAd;AAAmC;;AACxD;AAAS,eAAO,IAAP;AARX;;AAUA,WAAO;AAACzB,MAAAA,IAAI,EAAEA,IAAP;AAAa0B,MAAAA,WAAW,EAAEA;AAA1B,KAAP;AACD;;AAED,SAAOlB,QAAQ,CAACV,CAAD,CAAf;AACD","sourcesContent":["import reverse from \"./reverse.js\";\nimport transform from \"./transform.js\";\n\nexport default function(topology, o) {\n  if (typeof o === \"string\") o = topology.objects[o];\n  return o.type === \"GeometryCollection\"\n      ? {type: \"FeatureCollection\", features: o.geometries.map(function(o) { return feature(topology, o); })}\n      : feature(topology, o);\n}\n\nfunction feature(topology, o) {\n  var id = o.id,\n      bbox = o.bbox,\n      properties = o.properties == null ? {} : o.properties,\n      geometry = object(topology, o);\n  return id == null && bbox == null ? {type: \"Feature\", properties: properties, geometry: geometry}\n      : bbox == null ? {type: \"Feature\", id: id, properties: properties, geometry: geometry}\n      : {type: \"Feature\", id: id, bbox: bbox, properties: properties, geometry: geometry};\n}\n\nexport function object(topology, o) {\n  var transformPoint = transform(topology.transform),\n      arcs = topology.arcs;\n\n  function arc(i, points) {\n    if (points.length) points.pop();\n    for (var a = arcs[i < 0 ? ~i : i], k = 0, n = a.length; k < n; ++k) {\n      points.push(transformPoint(a[k], k));\n    }\n    if (i < 0) reverse(points, n);\n  }\n\n  function point(p) {\n    return transformPoint(p);\n  }\n\n  function line(arcs) {\n    var points = [];\n    for (var i = 0, n = arcs.length; i < n; ++i) arc(arcs[i], points);\n    if (points.length < 2) points.push(points[0]); // This should never happen per the specification.\n    return points;\n  }\n\n  function ring(arcs) {\n    var points = line(arcs);\n    while (points.length < 4) points.push(points[0]); // This may happen if an arc has only two points.\n    return points;\n  }\n\n  function polygon(arcs) {\n    return arcs.map(ring);\n  }\n\n  function geometry(o) {\n    var type = o.type, coordinates;\n    switch (type) {\n      case \"GeometryCollection\": return {type: type, geometries: o.geometries.map(geometry)};\n      case \"Point\": coordinates = point(o.coordinates); break;\n      case \"MultiPoint\": coordinates = o.coordinates.map(point); break;\n      case \"LineString\": coordinates = line(o.arcs); break;\n      case \"MultiLineString\": coordinates = o.arcs.map(line); break;\n      case \"Polygon\": coordinates = polygon(o.arcs); break;\n      case \"MultiPolygon\": coordinates = o.arcs.map(polygon); break;\n      default: return null;\n    }\n    return {type: type, coordinates: coordinates};\n  }\n\n  return geometry(o);\n}\n"]},"metadata":{},"sourceType":"module"}